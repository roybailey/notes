# K8

* [Kubernetes](https://kubernetes.io)
* [Kubernetes Documentation](https://kubernetes.io/docs/)
* [Kubernetes Documentation Concepts](https://kubernetes.io/docs/concepts/)
* [Kubernetes Documentation Setup](https://kubernetes.io/docs/setup/pick-right-solution/)
* [Kubernetes Documentation - Minikube Setup](https://kubernetes.io/docs/getting-started-guides/minikube/)
* [Oracle VirtualBox](https://www.virtualbox.org/](https://www.virtualbox.org/)
* [OSBoxes VM images](http://osboxes.org/](http://osboxes.org/)
* [kubeadm installation instructions](https://kubernetes.io/docs/setup/independent/install-kubeadm/](https://kubernetes.io/docs/setup/independent/install-kubeadm/)

## Overview

* **NODES** = MACHINE, kubelet agent, network proxy, container runtime
* **CLUSTER** = GROUP OF NODES
* **MASTER** = NODE CONTROLLING CLUSTER, api server, cluster store, controller & scheduler, etcd (key/value store)
* **PODS** = RUN 1..N CONTAINERS, has own IP, tightly coupled services usually run together, often only one
* **REPLICASETS** = HOW TO REPLICATE A POD
* **SERVICES** = IP addressed load balancer, pods accessed via labelling
* **DEPLOYMENTS** = DEPLOYMENT OF REPLICASETS, versioning, rollback plan, deactivation

> Master **api-server** talks to worker/minion nodes with **kubelet** agent

## Application Tips

* `jib-maven-plugin` builds docker images, maintains same image if code not changed
* Memory needs to be set with `-XX:Percentage` of container setting
** 80% max to allow for ssh onto box
* `kubectl create secret` will create namespace key/value encrypted in container, mappable to env variables for applications
* Log to console in app, so k8 container can be tailed and controls file capture itself
* `Ingress` type to create canary rollout, sits above `Service` load balancer and forwards % (or other criteria) to different service/pods for cautious rollout

## Udemy Course Notes

### Bridged Adapter on VirtualBox doesn't connect to Mac WiFi

In VirtualBox, VM's Network panel, click on advanced, click on Port Forwarding button. In there set up a rule:
```
Host IP: 127.0.0.1
Host Port: 2222
Guest IP: 10.0.2.15
Guest Port: 22
```
Then enable ssh in the guest, and I'm able to connect from the host using:

`ssh -p 2222 osboxes@127.0.0.1`

### minikube for single local K8

* `brew cask install minikube`
* `minikube start`



<!--stackedit_data:
eyJoaXN0b3J5IjpbLTE0MTE0MjQyNDAsMTcwOTcxMzk3NywxOT
g3MzU5MjIyLDE1MzY0NTgxMDAsMTc1ODI3ODk2OV19
-->